# Дистилляция и ускорение моделей
## Введение

## ПЛАН ЗАНЯТИЯ

### Вводная лекция
- Почему современные ML-модели становятся «слишком большими»
- Ограничения реального мира
- Зоопарк железа
- Research vs Production: разные критерии успеха
- Обзор классов методов ускорения и компрессии
- Инженерные компромиссы

### Семинар
- Анализ вычислительной сложности моделей
- Профилирование в PyTorch

---

## Современные ML-модели

- Современные ML-модели становятся «слишком большими»
- Большие модели могут не подойти для работы на реальном железе
- Малые модели подходят лучше
- В зависимости от железа мы получаем разные требования к моделям
- Следует применять ИИ там где это действительно необходимо
- Большой пул задач решается и без ИИ

**Пример:** Архитектура YOLO v11

---

## Ограничения реального мира

- Аппаратная архитектура
- Производительность
- Память (объем и организация)
- Сенсоры и датчики
- Пропускная способность
- Связь с внешним миром
- Электропитание
- Стоимость

---

## Зоопарк железа

- Мощные платформы
- Бюджетные платформы
- Специализированные (со своим форматом сети)
- Кастомизируемые (ПЛИС)

---

## Research vs Production: разные критерии успеха

### Research
- Глубина проработки
- Потенциал применимости
- Новизна и оригинальность
- Модульность
- Универсальность
- Избыточность
- Гибкость доработки

### Production
- Надежность
- Быстродействие
- Завершенность
- Масштабируемость
- Энергоэффективность
- Соответствие требованиям
- Удовлетворенность пользователя

---

## Обзор классов методов ускорения и компрессии

- Дистилляция знаний
- Квантование моделей
- Прунинг
- Архитектурные способы
- Аппаратное ускорение
- Оптимизация инференса
- Комбинированные подходы

---

## Инженерные компромиссы

- Железо подбирается под задачу
- Всегда придется чем-то пожертвовать
- Отложенные проблемы не исчезнут
- Техподдержка это не разработка
- Развитие продукта

---

## Анализ вычислительной сложности моделей

### Источники вычислительных затрат в моделях
- Архитектура
- Типы данных
- Объем вычислений

### Профилирование моделей
- Параметры
- Память
- Быстродействие

### Интерпретация результатов
- Выявление проблемных мест (bottleneck`ов)
- Поиск методов ускорения

---

## Профилирование в PyTorch

```python
import torch
import numpy as np
from torch import nn
import torch.autograd.profiler as profiler
```

- Выбор модели для профилирования
- Разработка тестов
- Измерение нагрузки на процессор и использование памяти

---

## Полезные ссылки

- https://habr.com/ru/companies/magnus-tech/articles/926260/
- https://promwad.com/news/top-hardware-platforms-embedded-ai-2025
- https://docs.pytorch.org/tutorials/beginner/profiler.html
- https://docs.pytorch.org/tutorials/deep-dive.html
- https://fastmachinelearning.org/hls4ml/

---

## Домашнее задание

- Выбрать модель, используемую в одной из областей: Computer Vision / Nature Language Processing / Speech Recognition / Recommendation system
- Выбрать целевую аппаратную платформу
- Проанализировать архитектуру модели
- Выявить основные источники вычислительных затрат
- Сформулировать ограничения (пропускная способность, память, железо)
- Предложить гипотезы по возможному ускорению

### Оформить результаты исследований:
- описание модели
- краткий аналитический отчет
- перечень проблемных мест (bottleneck`ов)
- возможные методы ускорения
- ожидаемые инженерные компромиссы
